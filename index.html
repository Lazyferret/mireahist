<!DOCTYPE html>
<html>
   <head>
      <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
      <meta charset="utf-8">
      <title>Quiz</title>
      <style>
         /*css reset */
         
		   h1,h2,h3,h4,h5,h6,p,label,a{color:black;}
         h1 {font-size: 4rem;}
         h2 {font-size: 5rem;}
         label {font-size: 3.8rem;}
         p {font-size: 2.8rem;}
         input {transform: scale(3);}
         button {transform: scale(3.5);}


         
      </style>
   </head>
   <script src="HistoryQuestionsNew.js"></script>
   <script>
   var historyChoices = [];
   function getMultipleRandom(arr, num) {
      const shuffled = [...arr].sort(() => 0.5 - Math.random());

      return shuffled.slice(0, num);
      }
	   var quiz = getMultipleRandom(data,10);
      

      var currentQuestion = 0;
      var backCurrentQuestion = -1;
      var score = 0;
      var askingQuestion = true;

      function back(){

      loadBackQuestion();
      }
      function loadBackQuestion(){

      var radioButton;

      //clear out radio buttons from previous question
      document.getElementById('content').innerHTML = "";

      //loop through choices, and create radio buttons
      for(var i=0; i < quiz[currentQuestion+backCurrentQuestion]["choices"].length; i++){

      	radioButton  = document.createElement('input');
      	radioButton.type = 'radio';
      	radioButton.name = 'quiz';
      	radioButton.id = 'choice'+ (i+1);
      	radioButton.value = quiz[currentQuestion+backCurrentQuestion]["choices"][i];

      	//create label tag, which hold the actual text of the choices
      	var label = document.createElement('label');
      	label.setAttribute('for','choice'+ (i+1));
      	label.innerHTML = quiz[currentQuestion+backCurrentQuestion]["choices"][i];

      	//create a <br> tag to separate options
      	var br = document.createElement('br');

      	//attach them to content. Attach br tag, then label, then radio button
      	document.getElementById('content').insertBefore(br, null);
      	document.getElementById('content').insertBefore(label, br);
      	document.getElementById('content').insertBefore(radioButton, label);
      }

      //load the question
      document.getElementById('question').innerHTML = quiz[currentQuestion+backCurrentQuestion]["question"];
      document.getElementById('score').innerHTML = '<p>Счёт: '+ score +' правильных из ' + quiz.length +' возможных. '+ String(parseInt(currentQuestion)+parseInt(1))+'/'+quiz.length+'</p>';

      backCurrentQuestion--;
      }
      function loadQuestion(){
      //set temporary variable for creating radio buttons
      var radioButton;
      
      //clear out radio buttons from previous question
      document.getElementById('content').innerHTML = "";
      
      //loop through choices, and create radio buttons
      for(var i=0; i < quiz[currentQuestion]["choices"].length; i++){
      	
      	radioButton  = document.createElement('input');
      	radioButton.type = 'radio';
      	radioButton.name = 'quiz';
      	radioButton.id = 'choice'+ (i+1);
      	radioButton.value = quiz[currentQuestion]["choices"][i];
      	
      	//create label tag, which hold the actual text of the choices
      	var label = document.createElement('label');
      	label.setAttribute('for','choice'+ (i+1));
      	label.innerHTML = quiz[currentQuestion]["choices"][i];
      	
      	//create a <br> tag to separate options
      	var br = document.createElement('br');
      	
      	//attach them to content. Attach br tag, then label, then radio button
      	document.getElementById('content').insertBefore(br, null);
      	document.getElementById('content').insertBefore(label, br);
      	document.getElementById('content').insertBefore(radioButton, label);
      }
      
      //load the question
      document.getElementById('question').innerHTML = quiz[currentQuestion]["question"];
      document.getElementById('score').innerHTML = '<p>Счёт: '+ score +' правильных из ' + quiz.length +' возможных. '+ String(parseInt(currentQuestion)+parseInt(1))+'/'+quiz.length+'</p>';
      
      //setup score for first time
      if(currentQuestion == 0){
      	document.getElementById('score').innerHTML = '<p>Счёт: 0 правильных из ' + quiz.length +' возможных. ' + String(parseInt(currentQuestion)+parseInt(1)) +'/'+quiz.length+'</p>';
      }
      }
      var correctIndex;
      function checkAnswer(){
      
      //are we asking a question, or proceeding to next question?
      if(askingQuestion){
      	
      	//change button text to next question, so next time they click it, it goes to next question
      	document.getElementById('check').innerHTML = 'Следующий вопрос';
      	askingQuestion = false;
      	
      	//determine which radio button they clicked
      	var userpick;

      	var radios = document.getElementsByName('quiz');
      	for(var i=0; i < radios.length; i++){
      		if(radios[i].checked){ //if this radio button is checked
      			userpick = radios[i].value;
      		}
      		//get index of correct answer
      		if(radios[i].value == quiz[currentQuestion]["correct"]){
      			correctIndex = i;

      		}
      	}
      	
      	//set the color if they got it right, or wrong
      	if(userpick == quiz[currentQuestion]["correct"]){
      		score++;
      		document.getElementsByTagName('label')[correctIndex].style.color = "green";
      		document.getElementsByTagName('label')[correctIndex].style.fontWeight = "bold";
      		document.getElementById('explanation').innerHTML = "<h3>Correct!</h3>";
      		historyChoices.push([correctIndex,"green"]);
      	} else {
      		document.getElementsByTagName('label')[correctIndex].style.color = "red";
      		document.getElementsByTagName('label')[correctIndex].style.fontWeight = "bold";
      		document.getElementById('explanation').innerHTML = "<h3>Incorrect</h3>";
      		historyChoices.push([correctIndex,"red"]);
      	}
      	
      	document.getElementById('explanation').innerHTML += '<p>' + quiz[currentQuestion]["explanation"] + '</p>';
      	document.getElementById('score').innerHTML = '<p>Счёт: '+ score +' правильных из ' + quiz.length +' возможных. '+ String(parseInt(currentQuestion)+parseInt(1))+'/'+quiz.length+'</p>';
      	
      	
      } else { //reset form and move to next question
      
      	//setting up so user can ask a question
      	askingQuestion = true;

      	//change button text back to 'submit answer'
      	document.getElementById('check').innerHTML = 'Подтвердить';
      	
      	document.getElementById('explanation').innerHTML = "";
      	
      	//if we're not on last question, increase question number
      	if(currentQuestion < quiz.length - 1){
      		currentQuestion++;
      		loadQuestion();
      	} else {
      		showFinalResults();
      	}
      
      }
      }
      
      function showFinalResults(){
      
      document.getElementById('content').innerHTML = '<h2>Вы завершили попытку</h2>';
      document.getElementById('content').innerHTML += '<p>Результаты:</p>';
      document.getElementById('content').innerHTML += '<h2>' + score + ' из ' + quiz.length + ' вопросов, ' + Math.round(score/quiz.length * 100) + '%</h2>';
      document.getElementById('content').innerHTML += '<button class="btn btn-success fixed-bottom" onclick="window.location.reload();" style="margin-bottom: 30px;">Повторить</button>'
      //delete the button
      var button_check = document.getElementById('check');
      var button_back = document.getElementById('back');
      button_check.parentNode.removeChild(button_check); //js requires you to delete elements from the parent
      button_back.parentNode.removeChild(button_back);
      //remove question
      document.getElementById('question').innerHTML = "";
      
      }
      
      
      window.onload = loadQuestion;
	  loadQuestion();
      
   </script>
   <body>
      <div class="container-lg">
        
      <div class="row mb-3" id="frame">
         <div id="score">
            <p>score: 0 right answers out of 0 possible</p>
         </div>
         <h2 id="question">Question here</h2>
         <div id="content">
            <input type="radio" id="quiz" value="1" name="fav_language">
            <hr>
            <input type="radio" id="quiz" value="2" name="fav_language">
            <hr>
            <input type="radio" id="quiz" value="3" name="fav_language">
         </div>
         <div id="response">
            <div id="explanation"></div>
         </div>
      </div>
      <div class="row lg-3 fixed-bottom" id="frame" style="margin-bottom: 30px;">
         <div class="col">
            <button id="back" onclick="back()" class="btn btn-secondary" style="width:20%;margin-left:10%">Назад</button>
         </div>
         <div class="col">
            <button id="check" onclick="checkAnswer()" class="btn btn-primary" style="width:50%;margin-left:10%">Подтвердить</button>
         </div>
      </div>
      
      </div>
   </body>
</html>
